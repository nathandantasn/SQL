-- AULA 02/06

USE VENDA;

SELECT * FROM CLIENTE;
SELECT * FROM PRODUTO;
SELECT * FROM VENDEDOR;
SELECT * FROM VENDA;
SELECT * FROM ITEM_VENDA;
SELECT * FROM PRATELEIRA;

-- 1
SELECT NOME FROM PRODUTO
WHERE VALOR = (SELECT MIN (VALOR) FROM PRODUTO);

-- 2
ALTER TABLE VENDEDOR
ADD SOBRENOME VARCHAR(50);

-- 3
SELECT NOME, SOBRENOME FROM VENDEDOR
WHERE MATRICULA NOT IN 
(SELECT VD.MATRICULA FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA);

-- 4
SELECT NOME, SOBRENOME, IDADE FROM VENDEDOR
WHERE SALARIO = (SELECT MAX (SALARIO) FROM VENDEDOR)
ORDER BY IDADE;

-- 5
SELECT AVG (SALARIO) AS MEDIA_SALARIO FROM VENDEDOR
WHERE IDADE > 35;

-- 6
SELECT COUNT (VD.MATRICULA) AS CONTADOR, AVG (VD.SALARIO) AS MEDIA_SALARIAL 
FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA
AND V.DATA_VENDA = '19/05/2021';

-- 7
SELECT COUNT (V.MATRICULA) AS CONTADOR FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA
AND VD.NOME = 'NATHAN';

-- 8
SELECT COUNT (NOME) AS CONTADOR FROM VENDEDOR
WHERE MATRICULA NOT IN (SELECT VD.MATRICULA FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA)

-- 9 - CALCULAR A SOMA DOS SALÁRIOS DOS VENDEDORES QUE PARTICIPARAM 
-- DE PELO MENOS UMA VENDA
SELECT SUM (SALARIO) FROM VENDEDOR
WHERE MATRICULA IN (SELECT VD.MATRICULA FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA);

-- 10
SELECT CIDADE, COUNT (COD_CLIENTE) AS CONTADOR FROM CLIENTE
GROUP BY CIDADE
HAVING COUNT (COD_CLIENTE) > 1;





SELECT * FROM CLIENTE;
SELECT * FROM VENDEDOR;
SELECT * FROM VENDA;

