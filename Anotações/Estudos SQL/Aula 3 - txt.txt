--ELIMINAR OS ITENS DA VENDA EXISTENTE
DELETE FROM ITEM_VENDA

--ELIMINAR OS ITENS DA VENDA
DELETE FROM VENDA
WHERE COD_VENDA = 123;

--ALTERAR A TABELA VENDA E ELIMINAR A COLUNA VALOR
ALTER TABLE VENDA
DROP COLUMN VALOR;

--ALTERAR A TABELA VENDEDOR E INCLUIR A IDADE
ALTER TABLE VENDEDOR
ADD IDADE INT; 

--ALTERAR A TABELA CLIENTE E INCLUIR A COLUNA SOBRENOME
ALTER TABLE CLIENTE
ADD SOBRENOME VARCHAR(50);

--MODIFICAR O ENDEREÇO DO CLIENTE 103 PARA AVENIDA PARANÁ
UPDATE CLIENTE
SET ENDERECO = 'AVENIDA PARANÁ'
WHERE COD_CLIENTE = 103;

--AUMENTAR O SALÁRIO DE TODOS OS VENDEDORES EM 10%
UPDATE VENDEDOR
SET SALARIO = SALARIO + SALARIO * 0.1

--ELIMINAR A VENDEDORA VANESSA
DELETE FROM VENDEDOR
WHERE NOME = 'VANESSA';

INSERT INTO VENDA
VALUES (127, '2021-05-19', 102, 12231),
	   (128, '2021-05-26', 103, 12231),
	   (129, '2021-05-26', 102, 12231);

--BUSCA SIMPLES MAS PARA PROJETAR APENAS ALGUMAS COLUNAS
SELECT COD_CLIENTE FROM VENDA;

--BUSCAR A MATRICULA E NOME DOS VENDEDORES
SELECT MATRICULA, NOME FROM VENDEDOR;

--DISTINCT 
SELECT DISTINCT COD_CLIENTE FROM VENDA;

--A)
SELECT COD_CLIENTE FROM CLIENTE
WHERE CIDADE = 'SÃO PAULO';

--B)
SELECT MATRICULA FROM VENDEDOR
WHERE SALARIO > 2000 AND IDADE < 35;

--C)
SELECT NOME FROM CLIENTE
WHERE CIDADE = 'MAUÁ' OR CIDADE = 'SÃO CAETANO DO SUL';

--BUSCA ORDENADA
SELECT NOME, SALARIO FROM VENDEDOR
ORDER BY SALARIO ASC;

SELECT NOME, SALARIO FROM VENDEDOR
ORDER BY SALARIO DESC;

--JOIN
SELECT VENDA.COD_VENDA, VENDEDOR.NOME 
FROM VENDA, VENDEDOR
WHERE VENDA.MATRICULA = VENDEDOR.MATRICULA; 

--ALIAS
SELECT V.COD_VENDA, VD.NOME 
FROM VENDA V, VENDEDOR VD
WHERE V.MATRICULA = VD.MATRICULA; 

--APELIDO PARA AS COLUNAS
SELECT V.COD_VENDA AS COD_VENDA, VD.NOME AS VENDEDOR, C.NOME AS CLIENTE 
FROM VENDA V, VENDEDOR VD, CLIENTE C
WHERE V.MATRICULA = VD.MATRICULA 
AND V.COD_CLIENTE = C.COD_CLIENTE;

-- BUSCAR O CÓDIGO DA VENDA, O NOME DO VENDEDOR QUE A REALIZOU E O NOME DO CLIENTE
-- APENAS DOS CLIENTES QUE RESIDEM NA CIDADE DE MAUÁ
SELECT VENDA.COD_VENDA AS COD_VENDA, VENDEDOR.NOME AS NOME_VENDEDOR, CLIENTE.NOME AS NOME_CLIENTE, CLIENTE.CIDADE AS CIDADE_CLIENTE
FROM VENDA, VENDEDOR, CLIENTE
WHERE VENDA.MATRICULA = VENDEDOR.MATRICULA
AND VENDA.COD_CLIENTE = CLIENTE.COD_CLIENTE
AND CLIENTE.CIDADE = 'MAUÁ'; 

--BUSCAR VENDEDORES QUE REALIZARAM ALGUMA VENDA DIA 19/05/2021
SELECT VD.NOME 
FROM VENDEDOR VD, VENDA V
WHERE VD.MATRICULA = V.MATRICULA
AND V.DATA_VENDA = '19/05/2021';

--INCLUIR IDADE PARA O VENDEDOR
UPDATE VENDEDOR
SET IDADE = 22
WHERE NOME = 'NATHAN DANTAS';

--NOME DOS VENDEDORES QUE FIZERAM VENDAS NO DIA 19/05/2021 E A IDADE É SUPERIOR A 35
SELECT VD.NOME 
FROM VENDEDOR VD, VENDA V
WHERE V.MATRICULA = VD.MATRICULA
AND VD.IDADE < 35;

--FUNÇÕES DE AGREGAÇÕES DA TABELA VENDEDOR
SELECT AVG(SALARIO) media_salario, 
COUNT(SALARIO) contador,
MAX(SALARIO) maior_salario,
MIN(SALARIO) menor_salario,
SUM(SALARIO) soma_salarios
FROM  VENDEDOR;

--BUSCA SIMPLES
SELECT * FROM ITEM_VENDA;
SELECT * FROM VENDA;
SELECT * FROM PRODUTO;
SELECT * FROM CLIENTE;
SELECT * FROM VENDEDOR;
SELECT * FROM PRATELEIRA;